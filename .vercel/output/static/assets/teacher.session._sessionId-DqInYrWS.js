import{d as C,u as Q,c as n,a as x,r as g,j as e}from"./main-D9T9K9KV.js";import{a as i,L as S}from"./loader-circle-6RTZhKqC.js";import{c as N}from"./clsx-B-dksMZM.js";import{c}from"./createLucideIcon-ufO4wm03.js";import{U as q,m as h}from"./proxy-3tB_AP7q.js";import{P as M}from"./play-DGVMa_YX.js";const L=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],j=c("check",L);const _=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],I=c("circle-question-mark",_);const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],E=c("circle-stop",R);const P=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],T=c("copy",P);const A=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],$=c("zap",A);function J(){const{sessionId:t}=C.useParams(),a=Q(),l=n(i.sessions.getSession,{sessionId:t}),s=n(i.sessions.getLostStudentCount,{sessionId:t}),d=n(i.sessions.getStudentCount,{sessionId:t}),r=n(i.quizzes.getActiveQuiz,{sessionId:t}),o=x(i.quizzes.launchQuiz),m=x(i.quizzes.closeQuiz),v=x(i.sessions.endSession),[w,u]=g.useState(!1),[b,p]=g.useState(!1);if(!l)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"w-12 h-12 border-4 border-ink border-t-transparent rounded-full animate-spin"})});if(l.status==="ended")return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-milk border-2 border-ink rounded-3xl p-12 shadow-comic text-center max-w-lg w-full",children:[e.jsx("div",{className:"w-20 h-20 bg-soft-purple rounded-full border-2 border-ink flex items-center justify-center mx-auto mb-6",children:e.jsx(j,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-4xl font-black mb-4",children:"Class Dismissed!"}),e.jsx("p",{className:"text-lg font-medium text-slate-500 mb-8",children:"Great session today."}),e.jsx("button",{onClick:()=>a({to:"/teacher"}),className:"btn-primary w-full",children:"Back to Dashboard"})]})});const y=()=>{navigator.clipboard.writeText(l.code),u(!0),setTimeout(()=>u(!1),2e3)},k=async()=>{p(!0);try{await o({sessionId:t,questions:[{prompt:"What is the powerhouse of the cell?",choices:["Nucleus","Mitochondria","Ribosome","Golgi Body"],correctIndex:1,explanation:"Mitochondria generate most of the chemical energy needed to power the cell.",conceptTag:"biology"},{prompt:"Which organelle is unique to plant cells?",choices:["Mitochondria","Chloroplast","Nucleus","Cell Membrane"],correctIndex:1,explanation:"Chloroplasts conduct photosynthesis and are found in plant cells.",conceptTag:"bioscience"}]})}catch(f){console.error("Failed to launch quiz:",f)}p(!1)},z=async()=>{confirm("End this session?")&&(await v({sessionId:t}),await a({to:"/teacher"}))};return e.jsx("div",{className:"min-h-screen p-6 pb-20",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-milk border-2 border-ink rounded-2xl p-4 md:p-6 shadow-comic flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-coral text-white px-4 py-1 rounded-full border-2 border-ink font-bold transform -rotate-1 shadow-comic-sm",children:"LIVE"}),e.jsx("h1",{className:"text-2xl font-black",children:"Biology 101"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"hidden md:block font-bold text-slate-500 mr-2",children:"Join Code:"}),e.jsx("div",{className:"bg-mustard/20 px-4 py-2 rounded-xl border-2 border-ink border-dashed font-mono font-bold text-xl tracking-widest",children:l.code}),e.jsxs("div",{className:"bg-white border-2 border-ink rounded-xl px-4 py-2 shadow-comic-sm flex items-center gap-2 font-bold min-w-[100px] justify-center",children:[e.jsx(q,{className:"w-5 h-5 text-ink"}),e.jsxs("span",{children:[d??"..."," Students"]})]}),e.jsx("button",{onClick:y,className:"w-12 h-12 flex items-center justify-center bg-white border-2 border-ink rounded-xl shadow-comic-sm btn-press",children:w?e.jsx(j,{className:"w-5 h-5 text-green-600"}):e.jsx(T,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-milk border-2 border-ink rounded-[2rem] p-8 shadow-comic flex flex-col items-center text-center relative overflow-hidden min-h-[400px]",children:[e.jsx("div",{className:"absolute top-0 inset-x-0 h-4 bg-soft-purple border-b-2 border-ink"}),e.jsx("h2",{className:"text-xl font-black mt-4 mb-1",children:"Room Vibe"}),e.jsx("p",{className:"text-slate-500 font-bold text-sm uppercase tracking-wide opacity-70",children:"Confusion Level"}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative w-full py-8",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-10",children:e.jsx(h.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},className:"w-64 h-64 bg-mustard rounded-full blur-3xl"})}),e.jsx(h.div,{animate:{scale:1+(s||0)*.1,rotate:(s||0)*5},className:N("w-48 h-48 border-4 border-ink rounded-full flex items-center justify-center relative z-10 transition-colors duration-500 shadow-comic",(s||0)>3?"bg-coral":(s||0)>0?"bg-mustard":"bg-white"),children:(s||0)>3?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-ink"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-ink"})]}),e.jsx("div",{className:"w-12 h-4 bg-ink rounded-full"})]}):(s||0)>0?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-ink"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-ink"})]}),e.jsx("div",{className:"w-8 h-1 bg-ink"})]}):e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-6",children:[e.jsx("div",{className:"w-4 h-8 bg-ink rounded-full"}),e.jsx("div",{className:"w-4 h-8 bg-ink rounded-full"})]}),e.jsx("div",{className:"w-10 h-5 border-b-4 border-ink rounded-b-full"})]})}),e.jsxs("div",{className:"mt-8 flex gap-2 items-end",children:[e.jsx("span",{className:"text-6xl font-black tabular-nums leading-none",children:s??0}),e.jsx("span",{className:"font-bold text-slate-500 mb-1",children:"confused"})]})]})]}),e.jsxs("button",{onClick:z,className:"bg-white border-2 border-ink rounded-xl py-4 font-bold hover:bg-red-50 hover:text-red-500 transition-colors flex items-center justify-center gap-2 shadow-comic-sm btn-press",children:[e.jsx(E,{className:"w-5 h-5"})," End Class"]})]}),e.jsxs("div",{className:"lg:col-span-8 flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-mustard border-2 border-ink rounded-[2rem] p-8 shadow-comic relative overflow-hidden",children:[e.jsx("div",{className:"absolute -right-10 -bottom-10 opacity-20 transform rotate-12",children:e.jsx(I,{className:"w-64 h-64"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-3xl font-black",children:"Pop Quiz"}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-lg border-2 border-ink font-bold text-sm shadow-comic-sm",children:r?"ACTIVE NOW":"READY"})]}),r?e.jsxs("div",{className:"bg-white border-2 border-ink rounded-2xl p-6 shadow-comic-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Live Results"}),e.jsx("button",{onClick:()=>m({sessionId:t}),className:"px-4 py-2 bg-ink text-white rounded-lg font-bold hover:bg-slate-800",children:"Close Quiz"})]}),e.jsx(D,{quizId:r._id})]}):e.jsxs("div",{className:"flex flex-col items-start gap-6",children:[e.jsx("p",{className:"font-medium text-ink/80 text-lg max-w-md",children:"Generate a quick 2-question quiz based on the last 5 minutes of transcript."}),e.jsxs("button",{onClick:k,disabled:b,className:"bg-white text-ink w-full md:w-auto px-8 py-4 rounded-xl border-2 border-ink font-black text-xl shadow-comic flex items-center gap-3 disabled:opacity-50 disabled:shadow-none disabled:translate-y-0 btn-press",children:[b?e.jsx(S,{className:"animate-spin"}):e.jsx(M,{className:"fill-current"}),"Launch Quiz"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white border-2 border-ink rounded-2xl p-6 shadow-comic-sm hover:shadow-comic transition-all cursor-pointer group",children:[e.jsx("div",{className:"w-12 h-12 bg-soft-purple border-2 border-ink rounded-xl flex items-center justify-center mb-4 group-hover:-rotate-6 transition-transform",children:e.jsx($,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Polls"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Coming Soon"})]}),e.jsxs("div",{className:"bg-white border-2 border-ink rounded-2xl p-6 shadow-comic-sm opacity-50 border-dashed",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 border-2 border-gray-300 rounded-xl flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"})}),e.jsx("h3",{className:"font-bold text-lg text-gray-400",children:"Timer"})]})]})]})]})]})})}function D({quizId:t}){const a=n(i.quizzes.getQuizStats,{quizId:t});return a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-5xl font-black",children:a.totalResponses}),e.jsxs("div",{className:"text-sm font-bold text-slate-500 leading-tight",children:["Student",e.jsx("br",{}),"Responses"]})]}),e.jsx("div",{className:"space-y-4 max-h-[250px] overflow-y-auto custom-scrollbar pr-2",children:a.questions.map((l,s)=>e.jsxs("div",{className:"border-b-2 border-gray-100 pb-4 last:border-0",children:[e.jsxs("p",{className:"font-bold mb-3",children:[s+1,". ",l.prompt]}),e.jsx("div",{className:"space-y-2",children:a.choiceDistributions[s].map((d,r)=>{const o=r===l.correctIndex,m=a.totalResponses>0?Math.round(d/a.totalResponses*100):0;return e.jsxs("div",{className:"relative h-10 bg-gray-50 border border-gray-200 rounded-lg overflow-hidden flex items-center px-4",children:[e.jsx(h.div,{initial:{width:0},animate:{width:`${m}%`},className:N("absolute inset-y-0 left-0 opacity-20 transition-all",o?"bg-green-500":"bg-gray-400")}),e.jsxs("div",{className:"relative z-10 flex justify-between w-full text-sm font-bold",children:[e.jsxs("span",{className:o?"text-green-700":"text-slate-600",children:[String.fromCharCode(65+r),o&&" (Correct)"]}),e.jsx("span",{children:d})]})]},r)})})]},s))})]}):e.jsx("div",{className:"text-center py-8 font-bold text-slate-400 animate-pulse",children:"Waiting for responses..."})}export{J as component};
